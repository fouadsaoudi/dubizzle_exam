(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1063:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s={ME:"/me",ADS:"/ads",LOGIN:"/login",MY_ADS:"/my-ads",SUB_CATEGORIES:"/sub-categories",ADMIN_GET_ALL_ADS:"/admin-get-all-ads",UPDATE_AD_STATUS:"/update-ad-status",REGISTER:"/register"}},4937:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s={API_URL:"http://51.20.82.235:3000/api"}},5574:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),o=r(8093),a=r(2115),n=r(4937),l=r(1063),i=r(8941);function c(){let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(async()=>{try{let e=await (0,i.F)(n.A.API_URL+l.A.ADS,"GET");if(e instanceof Response&&e.ok){let r=await e.json();t(r.ads)}else console.error("Failed to fetch ads",e)}catch(e){console.error("Error fetching ads:",e)}finally{o(!1)}})()},[]),r)?(0,s.jsx)("div",{children:"Loading ads..."}):0===e.length?(0,s.jsx)("div",{children:"No ads available."}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e&&e.length>0&&e.map(e=>{var t;return(0,s.jsxs)("div",{className:"border p-4 rounded shadow hover:shadow-lg transition",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:e.title}),(0,s.jsx)("p",{className:"text-gray-600 mb-2",children:(null==(t=e.description)?void 0:t.substring(0,100))||"No description."}),(0,s.jsxs)("div",{className:"flex direction-row gap-2",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500 mb-2 bg-red-500 text-white p-1 rounded w-auto w-fit",children:e.category_name||""}),(0,s.jsx)("div",{className:"text-sm text-gray-500 mb-2 bg-blue-500 text-white p-1 rounded w-auto w-fit",children:e.sub_category_name||""})]}),(0,s.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:e.location||"Unknown location"}),(0,s.jsxs)("div",{className:"text-lg font-bold mb-2",children:["$",parseFloat(e.price).toFixed(2)]})]},e.id)})})}function d(){return(0,s.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,s.jsx)(o.A,{}),(0,s.jsxs)("main",{className:"flex flex-col items-center justify-center flex-grow p-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"List of Ads"}),(0,s.jsx)(c,{})," "]})]})}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},8093:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(5155),o=r(2115),a=r(5695),n=r(4937),l=r(1063),i=r(8941);function c(){let[e,t]=(0,o.useState)(null),[r,c]=(0,o.useState)(!0),d=(0,a.useRouter)();return(0,o.useEffect)(()=>{(async()=>{let e=localStorage.getItem("user");if(e){t(JSON.parse(e)),c(!1);return}if(!localStorage.getItem("token"))return c(!1);try{let e=await (0,i.F)(n.A.API_URL+l.A.ME,"POST");if(e instanceof Response&&e.ok){let r=await e.json();t(r.user),localStorage.setItem("user",JSON.stringify(r.user))}else localStorage.removeItem("token"),localStorage.removeItem("user")}catch(e){console.error("Failed to fetch user data:",e)}finally{c(!1)}})()},[]),(0,s.jsxs)("nav",{className:"sticky top-0 w-full bg-white shadow-md p-4 flex justify-between items-center",children:[(0,s.jsx)("div",{className:"text-xl font-bold text-blue-600 cursor-pointer",onClick:()=>d.push("/"),children:"Dubizzle"}),(0,s.jsx)("div",{className:"flex gap-4 items-center",children:r?(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}):e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"text-gray-700",children:["Welcome, ",(0,s.jsx)("span",{className:"font-semibold",children:e.username}),"!"]}),"admin"===e.role&&(0,s.jsx)("button",{onClick:()=>{d.push("/admin")},className:"px-4 py-2 cursor-pointer bg-blue-500 hover:bg-blue-600 text-white rounded transition",children:"Dashboard"}),(0,s.jsx)("button",{onClick:()=>{d.push("/profile")},className:"px-4 py-2 cursor-pointer bg-yellow-500 hover:bg-yellow-600 text-white rounded transition",children:"Profile"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),d.refresh()},className:"px-4 py-2 cursor-pointer bg-red-500 hover:bg-red-600 text-white rounded transition",children:"Logout"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("a",{href:"/register",className:"px-4 cursor-pointer py-2 bg-blue-500 hover:bg-blue-600 text-white rounded transition",children:"Register"}),(0,s.jsx)("a",{href:"/login",className:"px-4 py-2 cursor-pointer bg-green-500 hover:bg-green-600 text-white rounded transition",children:"Login"})]})})]})}},8675:(e,t,r)=>{Promise.resolve().then(r.bind(r,5574))},8941:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});let s=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{console.debug("fetchData debug",e,t);let s={Accept:"application/json"},o=localStorage.getItem("token");o&&(s.Authorization="Bearer ".concat(o));let a={method:t,headers:s};"GET"!==t&&(r instanceof FormData?(delete s["Content-Type"],a.body=r):(s["Content-Type"]="application/json",a.body=JSON.stringify(r)));let n=await fetch(e,a);if(401===n.status)return console.warn("Token expired or invalid. Redirecting to login..."),localStorage.removeItem("token"),window.location.href="/login",Error("Unauthorized. Redirecting to login.");return n}catch(e){return console.error("Error: fetchData",e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(8675)),_N_E=e.O()}]);