(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340],{1063:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s={ME:"/me",ADS:"/ads",LOGIN:"/login",MY_ADS:"/my-ads",SUB_CATEGORIES:"/sub-categories",ADMIN_GET_ALL_ADS:"/admin-get-all-ads",UPDATE_AD_STATUS:"/update-ad-status",REGISTER:"/register"}},2519:(e,t,r)=>{Promise.resolve().then(r.bind(r,6110))},4937:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s={API_URL:"http://13.48.5.152:8080/api"}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},6110:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),a=r(2115),l=r(5695),o=r(4937),n=r(1063),i=r(8941),c=r(8093);function d(){let[e,t]=(0,a.useState)(""),[r,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[h,p]=(0,a.useState)(0),[x,b]=(0,a.useState)([]),[g,f]=(0,a.useState)(null),[j,N]=(0,a.useState)({}),v=(0,l.useRouter)();(0,a.useEffect)(()=>{(async()=>{let e=await (0,i.F)(o.A.API_URL+n.A.SUB_CATEGORIES,"GET");e instanceof Response?b((e instanceof Response?await e.json():null).subCategories):console.error("Error fetching subcategories:",e)})()},[]);let y=async t=>{t.preventDefault();try{let t=await (0,i.F)(o.A.API_URL+n.A.ADS,"POST",{title:e,description:r,location:u,price:h,sub_category_id:g});if(t instanceof Response&&t.ok)alert("Ad created successfully!"),v.push("/");else{let e=t instanceof Response?await t.json():null;if(e.errors&&Array.isArray(e.errors)){let t={};e.errors.forEach(e=>{"object"==typeof e&&null!==e&&"path"in e&&"msg"in e&&(t[e.path]=e.msg)}),N(t)}else alert("Failed to create ad.")}}catch(e){console.error("Error creating ad:",e)}};return(0,s.jsxs)("div",{children:[(0,s.jsx)(c.A,{}),(0,s.jsxs)("div",{className:"max-w-2xl mx-auto p-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Create New Ad"}),(0,s.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:y,children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"title",className:"mb-1 font-semibold",children:"Title"}),(0,s.jsx)("input",{id:"title",type:"text",className:"border p-2 rounded",placeholder:"Enter ad title",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"description",className:"mb-1 font-semibold",children:"Description"}),(0,s.jsx)("textarea",{id:"description",className:"border p-2 rounded",placeholder:"Enter ad description",value:r,onChange:e=>d(e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"location",className:"mb-1 font-semibold",children:"Location"}),(0,s.jsx)("input",{id:"location",type:"text",className:"border p-2 rounded",placeholder:"Enter location",value:u,onChange:e=>m(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"price",className:"mb-1 font-semibold",children:"Price"}),(0,s.jsx)("input",{id:"price",type:"number",className:"border p-2 rounded",placeholder:"Enter price",value:h,onChange:e=>p(Number(e.target.value)),required:!0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"subCategory",className:"mb-1 font-semibold",children:"Sub-Category"}),(0,s.jsxs)("select",{id:"subCategory",className:"border p-2 rounded",value:null!=g?g:"",onChange:e=>f(Number(e.target.value)),required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select Sub-Category"}),x&&x.length>0&&x.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),j.price&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.price}),(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white p-2 rounded mt-4",children:"Create Ad"})]})]})]})}},8093:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(5155),a=r(2115),l=r(5695),o=r(4937),n=r(1063),i=r(8941);function c(){let[e,t]=(0,a.useState)(null),[r,c]=(0,a.useState)(!0),d=(0,l.useRouter)();return(0,a.useEffect)(()=>{(async()=>{let e=localStorage.getItem("user");if(e){t(JSON.parse(e)),c(!1);return}if(!localStorage.getItem("token"))return c(!1);try{let e=await (0,i.F)(o.A.API_URL+n.A.ME,"POST");if(e instanceof Response&&e.ok){let r=await e.json();t(r.user),localStorage.setItem("user",JSON.stringify(r.user))}else localStorage.removeItem("token"),localStorage.removeItem("user")}catch(e){console.error("Failed to fetch user data:",e)}finally{c(!1)}})()},[]),(0,s.jsxs)("nav",{className:"sticky top-0 w-full bg-white shadow-md p-4 flex justify-between items-center",children:[(0,s.jsx)("div",{className:"text-xl font-bold text-blue-600 cursor-pointer",onClick:()=>d.push("/"),children:"Dubizzle"}),(0,s.jsx)("div",{className:"flex gap-4 items-center",children:r?(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}):e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"text-gray-700",children:["Welcome, ",(0,s.jsx)("span",{className:"font-semibold",children:e.username}),"!"]}),"admin"===e.role&&(0,s.jsx)("button",{onClick:()=>{d.push("/admin")},className:"px-4 py-2 cursor-pointer bg-blue-500 hover:bg-blue-600 text-white rounded transition",children:"Dashboard"}),(0,s.jsx)("button",{onClick:()=>{d.push("/profile")},className:"px-4 py-2 cursor-pointer bg-yellow-500 hover:bg-yellow-600 text-white rounded transition",children:"Profile"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),d.refresh()},className:"px-4 py-2 cursor-pointer bg-red-500 hover:bg-red-600 text-white rounded transition",children:"Logout"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("a",{href:"/register",className:"px-4 cursor-pointer py-2 bg-blue-500 hover:bg-blue-600 text-white rounded transition",children:"Register"}),(0,s.jsx)("a",{href:"/login",className:"px-4 py-2 cursor-pointer bg-green-500 hover:bg-green-600 text-white rounded transition",children:"Login"})]})})]})}},8941:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});let s=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{console.debug("fetchData debug",e,t);let s={Accept:"application/json"},a=localStorage.getItem("token");a&&(s.Authorization="Bearer ".concat(a));let l={method:t,headers:s};"GET"!==t&&(r instanceof FormData?(delete s["Content-Type"],l.body=r):(s["Content-Type"]="application/json",l.body=JSON.stringify(r)));let o=await fetch(e,l);if(401===o.status)return console.warn("Token expired or invalid. Redirecting to login..."),localStorage.removeItem("token"),window.location.href="/login",Error("Unauthorized. Redirecting to login.");return o}catch(e){return console.error("Error: fetchData",e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(2519)),_N_E=e.O()}]);