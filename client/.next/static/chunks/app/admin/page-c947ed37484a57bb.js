(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1063:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r={ME:"/me",ADS:"/ads",LOGIN:"/login",MY_ADS:"/my-ads",SUB_CATEGORIES:"/sub-categories",ADMIN_GET_ALL_ADS:"/admin-get-all-ads",UPDATE_AD_STATUS:"/update-ad-status",REGISTER:"/register"}},4113:(e,t,s)=>{Promise.resolve().then(s.bind(s,5318))},4937:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r={API_URL:"http://13.48.5.152:8080/api"}},5318:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5155),a=s(2115),l=s(4937),n=s(1063),o=s(8941);let i=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"p-5 overflow-x-auto rounded-2xl border border-gray-200 shadow",children:(0,r.jsx)("table",{className:"table-auto min-w-full divide-y divide-gray-200 text-sm text-left bg-white",children:t})})},c=e=>{let{variant:t="primary",className:s="",...a}=e;return(0,r.jsx)("button",{className:"".concat("px-4 py-2 rounded-2xl font-semibold text-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-gray-200 text-black hover:bg-gray-300"}[t]," ").concat(s),...a,children:a.children})},d=e=>{let{open:t,onClose:s,children:a}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-md p-4 relative",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-2 right-2 text-gray-500 hover:text-black",children:"\xd7"}),a]})}):null},u=e=>(0,r.jsx)("textarea",{className:"w-full p-2 border border-gray-300 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,...e});var h=s(8093),x=s(5695);function p(){let[e,t]=(0,a.useState)([]),[s,p]=(0,a.useState)(null),[g,m]=(0,a.useState)(!0),[j,b]=(0,a.useState)(!1),[y,f]=(0,a.useState)(""),N=(0,x.useRouter)();(0,a.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("user")||"{}");if(!e||"admin"!==e.role)return N.push("/");v()},[]);let v=async()=>{try{let e=await (0,o.F)(l.A.API_URL+n.A.ADMIN_GET_ALL_ADS,"GET");if(e instanceof Response&&e.ok){let s=await e.json();t(s.ads)}else console.error("Failed to fetch ads",e)}catch(e){console.error("Error fetching ads:",e)}finally{m(!1)}},A=async(e,t)=>{try{let s="rejected"===t?{status:t,rejection_reason:y}:{status:t},r=await (0,o.F)(l.A.API_URL+n.A.UPDATE_AD_STATUS+"/"+e,"PUT",s);r instanceof Response&&r.ok?(v(),S()):(console.error("Failed to update ad status",r),alert("Failed to update status."))}catch(e){console.error("Error updating ad status:",e),alert("Failed to update status.")}},w=e=>{p(e),b(!0),f("")},S=()=>{p(null),b(!1)};return g?(0,r.jsx)("p",{children:" Loading..."}):(0,r.jsxs)("div",{children:[(0,r.jsx)(h.A,{}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Moderate Ads"}),(0,r.jsxs)(i,{children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Title"}),(0,r.jsx)("th",{children:"Description"}),(0,r.jsx)("th",{children:"User"}),(0,r.jsx)("th",{children:"Category"}),(0,r.jsx)("th",{children:"Sub Category"}),(0,r.jsx)("th",{children:"Price"}),(0,r.jsx)("th",{children:"Location"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Rejection Reason"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:e&&e.length>0?e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-2",children:e.id}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.title}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.description}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.posted_by}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.category}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.sub_category}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.price?"$".concat(e.price):"N/A"}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.location||"N/A"}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsx)("span",{className:"\n											inline-flex px-3 py-1 rounded-full text-xs font-semibold capitalize\n											".concat("approved"===e.status?"bg-green-100 text-green-700":"","\n											").concat("pending"===e.status?"bg-yellow-100 text-gray-700":"","\n											").concat("rejected"===e.status?"bg-red-100 text-red-700":"","\n										"),children:e.status})}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.rejection_reason||"â€”"}),(0,r.jsxs)("td",{className:"px-4 py-2 space-x-2 flex",children:[(0,r.jsx)(c,{onClick:()=>A(e.id,"approved"),disabled:"approved"===e.status,className:"text-xs px-3 py-1",children:"Approve"}),(0,r.jsx)(c,{onClick:()=>w(e),disabled:"rejected"===e.status,variant:"secondary",className:"text-xs px-3 py-1 bg-red-300",children:"Reject"})]})]},e.id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:9,className:"text-center py-4 text-gray-400",children:"No ads found."})})})]}),(0,r.jsx)(d,{open:j,onClose:S,children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Reject Ad"}),(0,r.jsx)(u,{placeholder:"Enter rejection reason",value:y,onChange:e=>f(e.target.value)}),(0,r.jsxs)("div",{className:"mt-4 flex justify-end space-x-2",children:[(0,r.jsx)(c,{onClick:S,variant:"secondary",children:"Cancel"}),(0,r.jsx)(c,{onClick:()=>s&&A(s.id,"rejected"),disabled:!y.trim(),children:"Reject"})]})]})})]})]})}},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},8093:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var r=s(5155),a=s(2115),l=s(5695),n=s(4937),o=s(1063),i=s(8941);function c(){let[e,t]=(0,a.useState)(null),[s,c]=(0,a.useState)(!0),d=(0,l.useRouter)();return(0,a.useEffect)(()=>{(async()=>{let e=localStorage.getItem("user");if(e){t(JSON.parse(e)),c(!1);return}if(!localStorage.getItem("token"))return c(!1);try{let e=await (0,i.F)(n.A.API_URL+o.A.ME,"POST");if(e instanceof Response&&e.ok){let s=await e.json();t(s.user),localStorage.setItem("user",JSON.stringify(s.user))}else localStorage.removeItem("token"),localStorage.removeItem("user")}catch(e){console.error("Failed to fetch user data:",e)}finally{c(!1)}})()},[]),(0,r.jsxs)("nav",{className:"sticky top-0 w-full bg-white shadow-md p-4 flex justify-between items-center",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-blue-600 cursor-pointer",onClick:()=>d.push("/"),children:"Dubizzle"}),(0,r.jsx)("div",{className:"flex gap-4 items-center",children:s?(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}):e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"text-gray-700",children:["Welcome, ",(0,r.jsx)("span",{className:"font-semibold",children:e.username}),"!"]}),"admin"===e.role&&(0,r.jsx)("button",{onClick:()=>{d.push("/admin")},className:"px-4 py-2 cursor-pointer bg-blue-500 hover:bg-blue-600 text-white rounded transition",children:"Dashboard"}),(0,r.jsx)("button",{onClick:()=>{d.push("/profile")},className:"px-4 py-2 cursor-pointer bg-yellow-500 hover:bg-yellow-600 text-white rounded transition",children:"Profile"}),(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),d.push("/"),d.refresh()},className:"px-4 py-2 cursor-pointer bg-red-500 hover:bg-red-600 text-white rounded transition",children:"Logout"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("a",{href:"/register",className:"px-4 cursor-pointer py-2 bg-blue-500 hover:bg-blue-600 text-white rounded transition",children:"Register"}),(0,r.jsx)("a",{href:"/login",className:"px-4 py-2 cursor-pointer bg-green-500 hover:bg-green-600 text-white rounded transition",children:"Login"})]})})]})}},8941:(e,t,s)=>{"use strict";s.d(t,{F:()=>r});let r=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{console.debug("fetchData debug",e,t);let r={Accept:"application/json"},a=localStorage.getItem("token");a&&(r.Authorization="Bearer ".concat(a));let l={method:t,headers:r};"GET"!==t&&(s instanceof FormData?(delete r["Content-Type"],l.body=s):(r["Content-Type"]="application/json",l.body=JSON.stringify(s)));let n=await fetch(e,l);if(401===n.status)return console.warn("Token expired or invalid. Redirecting to login..."),localStorage.removeItem("token"),window.location.href="/login",Error("Unauthorized. Redirecting to login.");return n}catch(e){return console.error("Error: fetchData",e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(4113)),_N_E=e.O()}]);